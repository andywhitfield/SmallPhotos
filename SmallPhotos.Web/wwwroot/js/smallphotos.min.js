function smpInitialise(){$(window).resize(function(){$("aside").css("display","");$(".nav-close:visible").length>0&&($(".nav-close").css("display",""),$(".nav-show").css("display",""))});$(".nav-show").click(function(){$("aside").fadeToggle("fast");$(this).hide();$(".nav-close").show()});$(".nav-close").click(function(){$("aside").hide();$(this).hide();$(".nav-show").show()});$("[data-href]").click(function(n){return window.location.href=$(this).attr("data-href"),n.preventDefault(),!1});$("[data-depends]").each(function(){let t=$(this),n=$(t.attr("data-depends"));if(n.is("input"))n.on("keypress",function(n){if(t.attr("disabled")&&(n.keyCode||n.which)===13)return n.preventDefault(),!1});n.on("change input paste keyup pickmeup-change",function(){let n=$(this).val();t.prop("disabled",n===null||n.match(/^\s*$/)!==null)});n.trigger("change")});$("[data-confirm]").click(function(n){if(!confirm($(this).attr("data-confirm")))return n.preventDefault(),!1});$("[data-starred]").each(function(){function t(){n.attr("data-starred").toLowerCase()==="true"?(n.attr("title","Click to unstar this photo"),n.addClass("starred")):(n.attr("title","Click to star this photo"),n.removeClass("starred"))}let n=$(this);n.click(function(){let r=n.attr("data-photoid"),i=n.attr("data-starred").toLowerCase()==="true",u="api/photoapi/"+(i?"unstar":"star")+"/"+r;$.post(u,{},function(){n.attr("data-starred",i?"false":"true");t()})});t()})}function fullSizeImage(){var t=$(window),n=$("#fullimg"),f=$("#fullimg-scaled").prop("checked");if(f){var i=t.width()<=600,r=t.height()-(i?340:290),u=t.width()-(i?30:280);console.log("scaling image size to "+u+"x"+r);n.css("max-height",r);n.css("max-width",u)}else console.log("disabled image scaling, removing max height/width css"),n.css("max-height",""),n.css("max-width","")}coerceToArrayBuffer=function(n,t){var r,u,i;if(typeof n=="string"){for(n=n.replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(n),u=new Uint8Array(r.length),i=0;i<r.length;i++)u[i]=r.charCodeAt(i);n=u}if(Array.isArray(n)&&(n=new Uint8Array(n)),n instanceof Uint8Array&&(n=n.buffer),!(n instanceof ArrayBuffer))throw new TypeError("could not coerce '"+t+"' to ArrayBuffer");return n};coerceToBase64Url=function(n){var i,r,t;if(Array.isArray(n)&&(n=Uint8Array.from(n)),n instanceof ArrayBuffer&&(n=new Uint8Array(n)),n instanceof Uint8Array){for(i="",r=n.byteLength,t=0;t<r;t++)i+=String.fromCharCode(n[t]);n=window.btoa(i)}if(typeof n!="string")throw new Error("could not coerce to string");return n.replace(/\+/g,"-").replace(/\//g,"_").replace(/=*$/g,"")};